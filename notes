    SELECT t.tagname, 
           SUM( CASE WHEN r.amount > 0 THEN r.amount ELSE 0 END ) AS in, 
           ABS( SUM( CASE WHEN r.amount < 0 THEN r.amount ELSE 0 END ) ) AS out 
      FROM records r 
INNER JOIN recordtags rt 
        ON rt.recordid=r.recordid 
       AND r.userid=1 
       AND r.recordid IN (6339) 
INNER JOIN tags t ON t.tagid=rt.tagid 
  GROUP BY t.tagid
